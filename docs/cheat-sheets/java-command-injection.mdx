---
slug: java-command-injection
---

import LinkToRegistryRule from "/src/components/LinkToRegistryRule"
import CommandInjectionIntro from "/src/components/concept/_command-injection-intro.mdx"

# Command injection prevention for Java

<CommandInjectionIntro />

#### Check your project for these conditions:

```bash
semgrep --config p/java-command-injection
```

---

## 1. Running an OS command

### 1.A. Running OS commands with `Runtime.getRuntime().exec()`

`exec` executes the specified string command in a separate process. This is dangerous if a command string is controlled by user input and could result in a command injection.

Example:

```java
Runtime.getRuntime().exec("ls -la")
```

#### References

- [`exec` documentation](https://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html#exec(java.lang.String))

#### Mitigation

Try to avoid non-literal values for the command string. If it is not possible, then do not let running arbitrary commands, use a white list for inputs. Strip `!@#$;&*~"'{}][-+%^` characters from an input provided for command string. 

#### Semgrep rule

<LinkToRegistryRule ruleId="java.lang.security.audit.command-injection-formatted-runtime-call.command-injection-formatted-runtime-call" />

### 1.B. Running OS processes with ProcessBuilder

ProcessBuilder class is used to create operating system processes. If the command string is controlled by user input it could result in command injection. 
Example:

```java
Process p = new ProcessBuilder("ls", "-la").start();
```

#### References

[`ProcessBuilder` documentation](https://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html)

#### Mitigation

Try to avoid non-literal values for the command string. If it is not possible, then do not let running arbitrary commands, use a white list for inputs. Do not put command arguments in a command string, use parameterization instead. (TODO: explain it) 

#### Semgrep rule

<LinkToRegistryRule ruleId="java.lang.security.audit.command-injection-process-builder.command-injection-process-builder" />
